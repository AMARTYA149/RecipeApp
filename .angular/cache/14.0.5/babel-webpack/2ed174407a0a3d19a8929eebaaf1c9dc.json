{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RouterExceptionFilters = void 0;\n\nconst constants_1 = require(\"@nestjs/common/constants\");\n\nconst shared_utils_1 = require(\"@nestjs/common/utils/shared.utils\");\n\nconst base_exception_filter_context_1 = require(\"../exceptions/base-exception-filter-context\");\n\nconst exceptions_handler_1 = require(\"../exceptions/exceptions-handler\");\n\nconst constants_2 = require(\"../injector/constants\");\n\nconst iterare_1 = require(\"iterare\");\n\nclass RouterExceptionFilters extends base_exception_filter_context_1.BaseExceptionFilterContext {\n  constructor(container, config, applicationRef) {\n    super(container);\n    this.config = config;\n    this.applicationRef = applicationRef;\n  }\n\n  create(instance, callback, moduleKey, contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n    this.moduleContext = moduleKey;\n    const exceptionHandler = new exceptions_handler_1.ExceptionsHandler(this.applicationRef);\n    const filters = this.createContext(instance, callback, constants_1.EXCEPTION_FILTERS_METADATA, contextId, inquirerId);\n\n    if ((0, shared_utils_1.isEmpty)(filters)) {\n      return exceptionHandler;\n    }\n\n    exceptionHandler.setCustomFilters(filters.reverse());\n    return exceptionHandler;\n  }\n\n  getGlobalMetadata(contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n    const globalFilters = this.config.getGlobalFilters();\n\n    if (contextId === constants_2.STATIC_CONTEXT && !inquirerId) {\n      return globalFilters;\n    }\n\n    const scopedFilterWrappers = this.config.getGlobalRequestFilters();\n    const scopedFilters = (0, iterare_1.iterate)(scopedFilterWrappers).map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId)).filter(host => !!host).map(host => host.instance).toArray();\n    return globalFilters.concat(scopedFilters);\n  }\n\n}\n\nexports.RouterExceptionFilters = RouterExceptionFilters;","map":null,"metadata":{},"sourceType":"script"}